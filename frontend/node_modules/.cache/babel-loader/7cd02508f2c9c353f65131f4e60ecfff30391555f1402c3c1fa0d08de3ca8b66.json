{"ast":null,"code":"/*global module*/\nvar Buffer = require('safe-buffer').Buffer;\nvar DataStream = require('./data-stream');\nvar jwa = require('jwa');\nvar Stream = require('stream');\nvar toString = require('./tostring');\nvar util = require('util');\nvar JWS_REGEX = /^[a-zA-Z0-9\\-_]+?\\.[a-zA-Z0-9\\-_]+?\\.([a-zA-Z0-9\\-_]+)?$/;\nfunction isObject(thing) {\n  return Object.prototype.toString.call(thing) === '[object Object]';\n}\nfunction safeJsonParse(thing) {\n  if (isObject(thing)) return thing;\n  try {\n    return JSON.parse(thing);\n  } catch (e) {\n    return undefined;\n  }\n}\nfunction headerFromJWS(jwsSig) {\n  var encodedHeader = jwsSig.split('.', 1)[0];\n  return safeJsonParse(Buffer.from(encodedHeader, 'base64').toString('binary'));\n}\nfunction securedInputFromJWS(jwsSig) {\n  return jwsSig.split('.', 2).join('.');\n}\nfunction signatureFromJWS(jwsSig) {\n  return jwsSig.split('.')[2];\n}\nfunction payloadFromJWS(jwsSig, encoding) {\n  encoding = encoding || 'utf8';\n  var payload = jwsSig.split('.')[1];\n  return Buffer.from(payload, 'base64').toString(encoding);\n}\nfunction isValidJws(string) {\n  return JWS_REGEX.test(string) && !!headerFromJWS(string);\n}\nfunction jwsVerify(jwsSig, algorithm, secretOrKey) {\n  if (!algorithm) {\n    var err = new Error(\"Missing algorithm parameter for jws.verify\");\n    err.code = \"MISSING_ALGORITHM\";\n    throw err;\n  }\n  jwsSig = toString(jwsSig);\n  var signature = signatureFromJWS(jwsSig);\n  var securedInput = securedInputFromJWS(jwsSig);\n  var algo = jwa(algorithm);\n  return algo.verify(securedInput, signature, secretOrKey);\n}\nfunction jwsDecode(jwsSig, opts) {\n  opts = opts || {};\n  jwsSig = toString(jwsSig);\n  if (!isValidJws(jwsSig)) return null;\n  var header = headerFromJWS(jwsSig);\n  if (!header) return null;\n  var payload = payloadFromJWS(jwsSig);\n  if (header.typ === 'JWT' || opts.json) payload = JSON.parse(payload, opts.encoding);\n  return {\n    header: header,\n    payload: payload,\n    signature: signatureFromJWS(jwsSig)\n  };\n}\nfunction VerifyStream(opts) {\n  opts = opts || {};\n  var secretOrKey = opts.secret || opts.publicKey || opts.key;\n  var secretStream = new DataStream(secretOrKey);\n  this.readable = true;\n  this.algorithm = opts.algorithm;\n  this.encoding = opts.encoding;\n  this.secret = this.publicKey = this.key = secretStream;\n  this.signature = new DataStream(opts.signature);\n  this.secret.once('close', function () {\n    if (!this.signature.writable && this.readable) this.verify();\n  }.bind(this));\n  this.signature.once('close', function () {\n    if (!this.secret.writable && this.readable) this.verify();\n  }.bind(this));\n}\nutil.inherits(VerifyStream, Stream);\nVerifyStream.prototype.verify = function verify() {\n  try {\n    var valid = jwsVerify(this.signature.buffer, this.algorithm, this.key.buffer);\n    var obj = jwsDecode(this.signature.buffer, this.encoding);\n    this.emit('done', valid, obj);\n    this.emit('data', valid);\n    this.emit('end');\n    this.readable = false;\n    return valid;\n  } catch (e) {\n    this.readable = false;\n    this.emit('error', e);\n    this.emit('close');\n  }\n};\nVerifyStream.decode = jwsDecode;\nVerifyStream.isValid = isValidJws;\nVerifyStream.verify = jwsVerify;\nmodule.exports = VerifyStream;","map":{"version":3,"names":["Buffer","require","DataStream","jwa","Stream","toString","util","JWS_REGEX","isObject","thing","Object","prototype","call","safeJsonParse","JSON","parse","e","undefined","headerFromJWS","jwsSig","encodedHeader","split","from","securedInputFromJWS","join","signatureFromJWS","payloadFromJWS","encoding","payload","isValidJws","string","test","jwsVerify","algorithm","secretOrKey","err","Error","code","signature","securedInput","algo","verify","jwsDecode","opts","header","typ","json","VerifyStream","secret","publicKey","key","secretStream","readable","once","writable","bind","inherits","valid","buffer","obj","emit","decode","isValid","module","exports"],"sources":["D:/Student_Database_IITBH/frontend/node_modules/jws/lib/verify-stream.js"],"sourcesContent":["/*global module*/\nvar Buffer = require('safe-buffer').Buffer;\nvar DataStream = require('./data-stream');\nvar jwa = require('jwa');\nvar Stream = require('stream');\nvar toString = require('./tostring');\nvar util = require('util');\nvar JWS_REGEX = /^[a-zA-Z0-9\\-_]+?\\.[a-zA-Z0-9\\-_]+?\\.([a-zA-Z0-9\\-_]+)?$/;\n\nfunction isObject(thing) {\n  return Object.prototype.toString.call(thing) === '[object Object]';\n}\n\nfunction safeJsonParse(thing) {\n  if (isObject(thing))\n    return thing;\n  try { return JSON.parse(thing); }\n  catch (e) { return undefined; }\n}\n\nfunction headerFromJWS(jwsSig) {\n  var encodedHeader = jwsSig.split('.', 1)[0];\n  return safeJsonParse(Buffer.from(encodedHeader, 'base64').toString('binary'));\n}\n\nfunction securedInputFromJWS(jwsSig) {\n  return jwsSig.split('.', 2).join('.');\n}\n\nfunction signatureFromJWS(jwsSig) {\n  return jwsSig.split('.')[2];\n}\n\nfunction payloadFromJWS(jwsSig, encoding) {\n  encoding = encoding || 'utf8';\n  var payload = jwsSig.split('.')[1];\n  return Buffer.from(payload, 'base64').toString(encoding);\n}\n\nfunction isValidJws(string) {\n  return JWS_REGEX.test(string) && !!headerFromJWS(string);\n}\n\nfunction jwsVerify(jwsSig, algorithm, secretOrKey) {\n  if (!algorithm) {\n    var err = new Error(\"Missing algorithm parameter for jws.verify\");\n    err.code = \"MISSING_ALGORITHM\";\n    throw err;\n  }\n  jwsSig = toString(jwsSig);\n  var signature = signatureFromJWS(jwsSig);\n  var securedInput = securedInputFromJWS(jwsSig);\n  var algo = jwa(algorithm);\n  return algo.verify(securedInput, signature, secretOrKey);\n}\n\nfunction jwsDecode(jwsSig, opts) {\n  opts = opts || {};\n  jwsSig = toString(jwsSig);\n\n  if (!isValidJws(jwsSig))\n    return null;\n\n  var header = headerFromJWS(jwsSig);\n\n  if (!header)\n    return null;\n\n  var payload = payloadFromJWS(jwsSig);\n  if (header.typ === 'JWT' || opts.json)\n    payload = JSON.parse(payload, opts.encoding);\n\n  return {\n    header: header,\n    payload: payload,\n    signature: signatureFromJWS(jwsSig)\n  };\n}\n\nfunction VerifyStream(opts) {\n  opts = opts || {};\n  var secretOrKey = opts.secret||opts.publicKey||opts.key;\n  var secretStream = new DataStream(secretOrKey);\n  this.readable = true;\n  this.algorithm = opts.algorithm;\n  this.encoding = opts.encoding;\n  this.secret = this.publicKey = this.key = secretStream;\n  this.signature = new DataStream(opts.signature);\n  this.secret.once('close', function () {\n    if (!this.signature.writable && this.readable)\n      this.verify();\n  }.bind(this));\n\n  this.signature.once('close', function () {\n    if (!this.secret.writable && this.readable)\n      this.verify();\n  }.bind(this));\n}\nutil.inherits(VerifyStream, Stream);\nVerifyStream.prototype.verify = function verify() {\n  try {\n    var valid = jwsVerify(this.signature.buffer, this.algorithm, this.key.buffer);\n    var obj = jwsDecode(this.signature.buffer, this.encoding);\n    this.emit('done', valid, obj);\n    this.emit('data', valid);\n    this.emit('end');\n    this.readable = false;\n    return valid;\n  } catch (e) {\n    this.readable = false;\n    this.emit('error', e);\n    this.emit('close');\n  }\n};\n\nVerifyStream.decode = jwsDecode;\nVerifyStream.isValid = isValidJws;\nVerifyStream.verify = jwsVerify;\n\nmodule.exports = VerifyStream;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}