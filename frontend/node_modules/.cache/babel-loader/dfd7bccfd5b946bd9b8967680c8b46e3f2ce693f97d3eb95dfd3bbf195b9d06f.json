{"ast":null,"code":"\"use strict\";\n\n// Copyright 2021 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getErrorFromOAuthErrorResponse = exports.OAuthClientAuthHandler = void 0;\nconst querystring = require(\"querystring\");\nconst crypto_1 = require(\"../crypto/crypto\");\n/** List of HTTP methods that accept request bodies. */\nconst METHODS_SUPPORTING_REQUEST_BODY = ['PUT', 'POST', 'PATCH'];\n/**\n * Abstract class for handling client authentication in OAuth-based\n * operations.\n * When request-body client authentication is used, only application/json and\n * application/x-www-form-urlencoded content types for HTTP methods that support\n * request bodies are supported.\n */\nclass OAuthClientAuthHandler {\n  /**\n   * Instantiates an OAuth client authentication handler.\n   * @param clientAuthentication The client auth credentials.\n   */\n  constructor(clientAuthentication) {\n    this.clientAuthentication = clientAuthentication;\n    this.crypto = (0, crypto_1.createCrypto)();\n  }\n  /**\n   * Applies client authentication on the OAuth request's headers or POST\n   * body but does not process the request.\n   * @param opts The GaxiosOptions whose headers or data are to be modified\n   *   depending on the client authentication mechanism to be used.\n   * @param bearerToken The optional bearer token to use for authentication.\n   *   When this is used, no client authentication credentials are needed.\n   */\n  applyClientAuthenticationOptions(opts, bearerToken) {\n    // Inject authenticated header.\n    this.injectAuthenticatedHeaders(opts, bearerToken);\n    // Inject authenticated request body.\n    if (!bearerToken) {\n      this.injectAuthenticatedRequestBody(opts);\n    }\n  }\n  /**\n   * Applies client authentication on the request's header if either\n   * basic authentication or bearer token authentication is selected.\n   *\n   * @param opts The GaxiosOptions whose headers or data are to be modified\n   *   depending on the client authentication mechanism to be used.\n   * @param bearerToken The optional bearer token to use for authentication.\n   *   When this is used, no client authentication credentials are needed.\n   */\n  injectAuthenticatedHeaders(opts, bearerToken) {\n    var _a;\n    // Bearer token prioritized higher than basic Auth.\n    if (bearerToken) {\n      opts.headers = opts.headers || {};\n      Object.assign(opts.headers, {\n        Authorization: `Bearer ${bearerToken}}`\n      });\n    } else if (((_a = this.clientAuthentication) === null || _a === void 0 ? void 0 : _a.confidentialClientType) === 'basic') {\n      opts.headers = opts.headers || {};\n      const clientId = this.clientAuthentication.clientId;\n      const clientSecret = this.clientAuthentication.clientSecret || '';\n      const base64EncodedCreds = this.crypto.encodeBase64StringUtf8(`${clientId}:${clientSecret}`);\n      Object.assign(opts.headers, {\n        Authorization: `Basic ${base64EncodedCreds}`\n      });\n    }\n  }\n  /**\n   * Applies client authentication on the request's body if request-body\n   * client authentication is selected.\n   *\n   * @param opts The GaxiosOptions whose headers or data are to be modified\n   *   depending on the client authentication mechanism to be used.\n   */\n  injectAuthenticatedRequestBody(opts) {\n    var _a;\n    if (((_a = this.clientAuthentication) === null || _a === void 0 ? void 0 : _a.confidentialClientType) === 'request-body') {\n      const method = (opts.method || 'GET').toUpperCase();\n      // Inject authenticated request body.\n      if (METHODS_SUPPORTING_REQUEST_BODY.indexOf(method) !== -1) {\n        // Get content-type.\n        let contentType;\n        const headers = opts.headers || {};\n        for (const key in headers) {\n          if (key.toLowerCase() === 'content-type' && headers[key]) {\n            contentType = headers[key].toLowerCase();\n            break;\n          }\n        }\n        if (contentType === 'application/x-www-form-urlencoded') {\n          opts.data = opts.data || '';\n          const data = querystring.parse(opts.data);\n          Object.assign(data, {\n            client_id: this.clientAuthentication.clientId,\n            client_secret: this.clientAuthentication.clientSecret || ''\n          });\n          opts.data = querystring.stringify(data);\n        } else if (contentType === 'application/json') {\n          opts.data = opts.data || {};\n          Object.assign(opts.data, {\n            client_id: this.clientAuthentication.clientId,\n            client_secret: this.clientAuthentication.clientSecret || ''\n          });\n        } else {\n          throw new Error(`${contentType} content-types are not supported with ` + `${this.clientAuthentication.confidentialClientType} ` + 'client authentication');\n        }\n      } else {\n        throw new Error(`${method} HTTP method does not support ` + `${this.clientAuthentication.confidentialClientType} ` + 'client authentication');\n      }\n    }\n  }\n}\nexports.OAuthClientAuthHandler = OAuthClientAuthHandler;\n/**\n * Converts an OAuth error response to a native JavaScript Error.\n * @param resp The OAuth error response to convert to a native Error object.\n * @param err The optional original error. If provided, the error properties\n *   will be copied to the new error.\n * @return The converted native Error object.\n */\nfunction getErrorFromOAuthErrorResponse(resp, err) {\n  // Error response.\n  const errorCode = resp.error;\n  const errorDescription = resp.error_description;\n  const errorUri = resp.error_uri;\n  let message = `Error code ${errorCode}`;\n  if (typeof errorDescription !== 'undefined') {\n    message += `: ${errorDescription}`;\n  }\n  if (typeof errorUri !== 'undefined') {\n    message += ` - ${errorUri}`;\n  }\n  const newError = new Error(message);\n  // Copy properties from original error to newly generated error.\n  if (err) {\n    const keys = Object.keys(err);\n    if (err.stack) {\n      // Copy error.stack if available.\n      keys.push('stack');\n    }\n    keys.forEach(key => {\n      // Do not overwrite the message field.\n      if (key !== 'message') {\n        Object.defineProperty(newError, key, {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          value: err[key],\n          writable: false,\n          enumerable: true\n        });\n      }\n    });\n  }\n  return newError;\n}\nexports.getErrorFromOAuthErrorResponse = getErrorFromOAuthErrorResponse;","map":{"version":3,"names":["Object","defineProperty","exports","value","getErrorFromOAuthErrorResponse","OAuthClientAuthHandler","querystring","require","crypto_1","METHODS_SUPPORTING_REQUEST_BODY","constructor","clientAuthentication","crypto","createCrypto","applyClientAuthenticationOptions","opts","bearerToken","injectAuthenticatedHeaders","injectAuthenticatedRequestBody","_a","headers","assign","Authorization","confidentialClientType","clientId","clientSecret","base64EncodedCreds","encodeBase64StringUtf8","method","toUpperCase","indexOf","contentType","key","toLowerCase","data","parse","client_id","client_secret","stringify","Error","resp","err","errorCode","error","errorDescription","error_description","errorUri","error_uri","message","newError","keys","stack","push","forEach","writable","enumerable"],"sources":["D:/Student_Database_IITBH/frontend/node_modules/google-auth-library/build/src/auth/oauth2common.js"],"sourcesContent":["\"use strict\";\n// Copyright 2021 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getErrorFromOAuthErrorResponse = exports.OAuthClientAuthHandler = void 0;\nconst querystring = require(\"querystring\");\nconst crypto_1 = require(\"../crypto/crypto\");\n/** List of HTTP methods that accept request bodies. */\nconst METHODS_SUPPORTING_REQUEST_BODY = ['PUT', 'POST', 'PATCH'];\n/**\n * Abstract class for handling client authentication in OAuth-based\n * operations.\n * When request-body client authentication is used, only application/json and\n * application/x-www-form-urlencoded content types for HTTP methods that support\n * request bodies are supported.\n */\nclass OAuthClientAuthHandler {\n    /**\n     * Instantiates an OAuth client authentication handler.\n     * @param clientAuthentication The client auth credentials.\n     */\n    constructor(clientAuthentication) {\n        this.clientAuthentication = clientAuthentication;\n        this.crypto = (0, crypto_1.createCrypto)();\n    }\n    /**\n     * Applies client authentication on the OAuth request's headers or POST\n     * body but does not process the request.\n     * @param opts The GaxiosOptions whose headers or data are to be modified\n     *   depending on the client authentication mechanism to be used.\n     * @param bearerToken The optional bearer token to use for authentication.\n     *   When this is used, no client authentication credentials are needed.\n     */\n    applyClientAuthenticationOptions(opts, bearerToken) {\n        // Inject authenticated header.\n        this.injectAuthenticatedHeaders(opts, bearerToken);\n        // Inject authenticated request body.\n        if (!bearerToken) {\n            this.injectAuthenticatedRequestBody(opts);\n        }\n    }\n    /**\n     * Applies client authentication on the request's header if either\n     * basic authentication or bearer token authentication is selected.\n     *\n     * @param opts The GaxiosOptions whose headers or data are to be modified\n     *   depending on the client authentication mechanism to be used.\n     * @param bearerToken The optional bearer token to use for authentication.\n     *   When this is used, no client authentication credentials are needed.\n     */\n    injectAuthenticatedHeaders(opts, bearerToken) {\n        var _a;\n        // Bearer token prioritized higher than basic Auth.\n        if (bearerToken) {\n            opts.headers = opts.headers || {};\n            Object.assign(opts.headers, {\n                Authorization: `Bearer ${bearerToken}}`,\n            });\n        }\n        else if (((_a = this.clientAuthentication) === null || _a === void 0 ? void 0 : _a.confidentialClientType) === 'basic') {\n            opts.headers = opts.headers || {};\n            const clientId = this.clientAuthentication.clientId;\n            const clientSecret = this.clientAuthentication.clientSecret || '';\n            const base64EncodedCreds = this.crypto.encodeBase64StringUtf8(`${clientId}:${clientSecret}`);\n            Object.assign(opts.headers, {\n                Authorization: `Basic ${base64EncodedCreds}`,\n            });\n        }\n    }\n    /**\n     * Applies client authentication on the request's body if request-body\n     * client authentication is selected.\n     *\n     * @param opts The GaxiosOptions whose headers or data are to be modified\n     *   depending on the client authentication mechanism to be used.\n     */\n    injectAuthenticatedRequestBody(opts) {\n        var _a;\n        if (((_a = this.clientAuthentication) === null || _a === void 0 ? void 0 : _a.confidentialClientType) === 'request-body') {\n            const method = (opts.method || 'GET').toUpperCase();\n            // Inject authenticated request body.\n            if (METHODS_SUPPORTING_REQUEST_BODY.indexOf(method) !== -1) {\n                // Get content-type.\n                let contentType;\n                const headers = opts.headers || {};\n                for (const key in headers) {\n                    if (key.toLowerCase() === 'content-type' && headers[key]) {\n                        contentType = headers[key].toLowerCase();\n                        break;\n                    }\n                }\n                if (contentType === 'application/x-www-form-urlencoded') {\n                    opts.data = opts.data || '';\n                    const data = querystring.parse(opts.data);\n                    Object.assign(data, {\n                        client_id: this.clientAuthentication.clientId,\n                        client_secret: this.clientAuthentication.clientSecret || '',\n                    });\n                    opts.data = querystring.stringify(data);\n                }\n                else if (contentType === 'application/json') {\n                    opts.data = opts.data || {};\n                    Object.assign(opts.data, {\n                        client_id: this.clientAuthentication.clientId,\n                        client_secret: this.clientAuthentication.clientSecret || '',\n                    });\n                }\n                else {\n                    throw new Error(`${contentType} content-types are not supported with ` +\n                        `${this.clientAuthentication.confidentialClientType} ` +\n                        'client authentication');\n                }\n            }\n            else {\n                throw new Error(`${method} HTTP method does not support ` +\n                    `${this.clientAuthentication.confidentialClientType} ` +\n                    'client authentication');\n            }\n        }\n    }\n}\nexports.OAuthClientAuthHandler = OAuthClientAuthHandler;\n/**\n * Converts an OAuth error response to a native JavaScript Error.\n * @param resp The OAuth error response to convert to a native Error object.\n * @param err The optional original error. If provided, the error properties\n *   will be copied to the new error.\n * @return The converted native Error object.\n */\nfunction getErrorFromOAuthErrorResponse(resp, err) {\n    // Error response.\n    const errorCode = resp.error;\n    const errorDescription = resp.error_description;\n    const errorUri = resp.error_uri;\n    let message = `Error code ${errorCode}`;\n    if (typeof errorDescription !== 'undefined') {\n        message += `: ${errorDescription}`;\n    }\n    if (typeof errorUri !== 'undefined') {\n        message += ` - ${errorUri}`;\n    }\n    const newError = new Error(message);\n    // Copy properties from original error to newly generated error.\n    if (err) {\n        const keys = Object.keys(err);\n        if (err.stack) {\n            // Copy error.stack if available.\n            keys.push('stack');\n        }\n        keys.forEach(key => {\n            // Do not overwrite the message field.\n            if (key !== 'message') {\n                Object.defineProperty(newError, key, {\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    value: err[key],\n                    writable: false,\n                    enumerable: true,\n                });\n            }\n        });\n    }\n    return newError;\n}\nexports.getErrorFromOAuthErrorResponse = getErrorFromOAuthErrorResponse;\n//# sourceMappingURL=oauth2common.js.map"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}